(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=Phaser;var s=e.n(t);class i extends s().Scene{constructor(){super("MenuScene")}preload(){this.load.image("fondo","Assets/inicio.jpg")}create(){this.add.image(400,300,"fondo"),this.add.text(400,100,"Charming Cats:\nGet-a-Home",{fontSize:"64px",color:"#ffffffff"}).setOrigin(.5);const e=this.add.text(400,300,"Local Play",{fontSize:"24px",color:"#1dd627ff"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointover",()=>e.setStyle({fill:"#e7b14dff"})).on("pointout",()=>e.setStyle({fill:"#1dd627ff"})).on("pointerdown",()=>{this.scene.start("GameScene")})}}class a{constructor(e,t,s,i){this.id=t,this.scene=e,this.score=0,this.baseHeight=100,this.baseWidth=20,this.baseSpeed=300;const a=this.scene.add.graphics();a.fillStyle(65280),a.fillRect(0,0,this.baseWidth,this.baseHeight),a.generateTexture(`paddle-${t}`,this.baseWidth,this.baseHeight),a.destroy(),this.sprite=this.scene.physics.add.sprite(s,i,`paddle-${t}`),this.sprite.setImmovable(!0),this.sprite.setCollideWorldBounds(!0),this.sprite.body.allowGravity=!1}}class o extends s().Scene{constructor(){super("GameScene")}preload(){this.load.image("juego","Assets/juego.jpg")}init(){this.add.image(400,300,"juego"),this.players=new Map,this.inputsMapping=[],this.ball=null,this.isPaused=!1,this.escWasDown=!1}resume(){this.isPaused=!1}create(){for(let e=0;e<17;e++)this.add.rectangle(400,50*e+25,10,30,16777215);this.scoreLeft=this.add.text(100,50,"0",{fontSize:"48px",color:"#00ff00"}),this.scoreRight=this.add.text(700,50,"0",{fontSize:"48px",color:"#00ff00"}),this.createBounds(),this.createBall(),this.launchBall(),this.setUpPLayers(),this.players.forEach(e=>{this.physics.add.collider(this.ball,e.sprite)}),this.physics.add.overlap(this.ball,this.leftGoal,this.scoreRightGoal,null,this),this.physics.add.overlap(this.ball,this.rightGoal,this.scoreLeftGoal,null,this),this.escKey=this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes.ESC)}setUpPLayers(){const e=new a(this,"player1",50,300),t=new a(this,"player2",750,300);this.players.set("player1",e),this.players.set("player2",t),this.inputsMapping=[{playerId:"player1",upKey:"W",downKey:"S"},{playerId:"player2",upKey:"UP",downKey:"DOWN"}],this.inputsMapping=this.inputsMapping.map(e=>({playerId:e.playerId,upKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.upKey]),downKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.downKey])}))}scoreRightGoal(){const e=this.players.get("player2");e.score+=1,this.scoreRight.setText(e.score.toString()),e.score>=10?this.endGame("player2"):this.resetBall()}scoreLeftGoal(){const e=this.players.get("player1");e.score+=1,this.scoreLeft.setText(e.score.toString()),e.score>=2?this.endGame("player1"):this.resetBall()}resetBall(){this.ball.setVelocity(0,0),this.ball.setPosition(400,300),this.time.delayedCall(1e3,()=>{this.launchBall()})}createBounds(){this.leftGoal=this.physics.add.sprite(0,300,null),this.leftGoal.setDisplaySize(10,600),this.leftGoal.body.setSize(10,600),this.leftGoal.setImmovable(!1),this.leftGoal.setVisible(!1),this.rightGoal=this.physics.add.sprite(800,300,null),this.rightGoal.setDisplaySize(10,600),this.rightGoal.body.setSize(10,600),this.rightGoal.setImmovable(!1),this.rightGoal.setVisible(!1)}createBall(){const e=this.add.graphics();e.fillStyle(16777215),e.fillCircle(8,8,8),e.generateTexture("ball",16,16),e.destroy(),this.ball=this.physics.add.image(400,300,"ball"),this.ball.setCollideWorldBounds(!0),this.ball.setBounce(1)}launchBall(){const e=s().Math.Between(-30,30),t=Math.random()<.5?1:-1;this.ball.setVelocity(600*Math.cos(s().Math.DegToRad(e))*t,600*Math.sin(s().Math.DegToRad(e)))}endGame(e){this.ball.setVelocity(0,0),this.players.forEach(e=>{e.sprite.setVelocity(0,0)}),this.physics.pause();const t="player1"===e?"Left Player Wins!!":"Right Player Wins!!";this.add.text(400,250,t,{fontSize:"64px",color:"#00ff00"}).setOrigin(.5);const s=this.add.text(400,350,"Return",{fontSize:"32px",color:"#00ff00"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerover",()=>s.setColor("#ff0000")).on("pointerout",()=>s.setColor("#00ff00")).on("pointerdown",()=>{this.scene.start("MenuScene")})}tooglePause(){const e=!this.isPaused;this.setPauseState(e)}setPauseState(e){this.isPaused=e,e?(this.scene.launch("PauseScene",{originalScene:"GameScene"}),this.scene.pause()):(this.scene.stop(),this.scene.resume("GameScene"))}update(){this.escKey.isDown&&this.tooglePause(),this.inputsMapping.forEach(e=>{const t=this.players.get(e.playerId);e.upKeyObj.isDown?t.sprite.setVelocityY(-t.baseSpeed):e.downKeyObj.isDown?t.sprite.setVelocityY(t.baseSpeed):t.sprite.setVelocityY(0)})}}class r extends s().Scene{constructor(){super("PauseScene")}create(e){this.add.text(400,160,"Paused",{fontSize:"64px"}).setOrigin(.5);const t=this.add.text(400,320,"Resume",{fontSize:"60px"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerover",()=>t.setColor("#ff0000")).on("pointerout",()=>t.setColor("#00ff00")).on("pointerdown",()=>{this.scene.stop(),this.scene.resume(e.originalScene),this.scene.get(e.originalScene).resume()}),s=this.add.text(400,520,"Home",{fontSize:"60px"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerover",()=>s.setColor("#ff0000")).on("pointerout",()=>s.setColor("#00ff00")).on("pointerdown",()=>{this.scene.stop(),this.scene.stop(e.originalScene),this.scene.launch("MenuScene")})}}const l={type:s().AUTO,width:800,height:600,parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[i,o,r],backgroundColor:"#360246ff"};new(s().Game)(l)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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V0FFakMyRSxFQUFVdkgsS0FBS0ksSUFBSUMsS0FBSyxJQUFJLElBQUssT0FBTyxDQUMxQ0MsU0FBUyxTQUNWRSxVQUFVLElBQUtFLGVBQWUsQ0FBQ0MsZUFBYyxJQUMvQ0MsR0FBRyxjQUFjLElBQUkyRyxFQUFRZCxTQUFTLFlBQ3RDN0YsR0FBRyxhQUFhLElBQUkyRyxFQUFRZCxTQUFTLFlBQ3JDN0YsR0FBRyxjQUFlLEtBQ2ZaLEtBQUtlLE1BQU1nRyxPQUNYL0csS0FBS2UsTUFBTWdHLEtBQUtNLEVBQUtQLGVBQ3JCOUcsS0FBS2UsTUFBTThGLE9BQU8sY0FFMUIsRUN2QkosTUFBTWxDLEVBQVMsQ0FDWDZDLEtBQU0sU0FDTkMsTUFBTyxJQUNQQyxPQUFRLElBQ1JDLE9BQVEsaUJBQ1I1RixRQUFTLENBQ0w2RixRQUFTLFNBQ1RDLE9BQVEsQ0FDSkMsUUFBUyxDQUFDMUcsRUFBRyxHQUNiMkcsT0FBTyxJQUlmaEgsTUFBTyxDQUFDbkIsRUFBV3dDLEVBQVdnRixHQUM5QlksZ0JBQWlCLGFBR1IsSUFBSSxVQUFZckQsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWNlL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3ByYWN0aWNlL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3ByYWN0aWNlL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9wcmFjdGljZS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3ByYWN0aWNlL2V4dGVybmFsIHZhciBcIlBoYXNlclwiIiwid2VicGFjazovL3ByYWN0aWNlLy4vc3JjL3NjZW5lL01lbnVTY2VuZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9lbnRpdGllcy9QYWRkbGUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvc2NlbmUvR2FtZVNjZW5lLmpzIiwid2VicGFjazovL3ByYWN0aWNlLy4vc3JjL3NjZW5lL1BhdXNlU2NlbmUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvbWFpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IFBoYXNlcjsiLCJpbXBvcnQgUGhhc2VyIGZyb20gXCJwaGFzZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNZW51U2NlbmUgZXh0ZW5kcyBQaGFzZXIuU2NlbmUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoJ01lbnVTY2VuZScpXHJcbiAgICB9XHJcblxyXG4gICAgcHJlbG9hZCgpe1xyXG4gICAgICAgIHRoaXMubG9hZC5pbWFnZSgnZm9uZG8nLCAnQXNzZXRzL2luaWNpby5qcGcnKTtcclxuICAgIH1cclxuICAgXHJcbiAgICBjcmVhdGUoKSB7XHJcbiAgICAgICAgdGhpcy5hZGQuaW1hZ2UoNDAwLCAzMDAsICdmb25kbycpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuYWRkLnRleHQoNDAwLDEwMCwgJ0NoYXJtaW5nIENhdHM6XFxuR2V0LWEtSG9tZScsXHJcbiAgICAgICAgeyAgIGZvbnRTaXplOiAnNjRweCcsXHJcbiAgICAgICAgICAgIGNvbG9yOiAnI2ZmZmZmZmZmJ1xyXG4gICAgICAgIH0pLnNldE9yaWdpbigwLjUpO1xyXG5cclxuICAgICAgICBjb25zdCBsb2NhbEJ0biA9IHRoaXMuYWRkLnRleHQoNDAwLCAzMDAsICdMb2NhbCBQbGF5Jywge1xyXG4gICAgICAgICAgICBmb250U2l6ZTogJzI0cHgnLCBjb2xvcjogJyMxZGQ2MjdmZidcclxuICAgICAgICB9KS5zZXRPcmlnaW4oMC41KVxyXG4gICAgICAgIC5zZXRJbnRlcmFjdGl2ZSh7dXNlSGFuZEN1cnNvcjogdHJ1ZX0pXHJcbiAgICAgICAgLm9uKCdwb2ludG92ZXInLCAoKSA9PiBsb2NhbEJ0bi5zZXRTdHlsZSh7ZmlsbDogJyNlN2IxNGRmZid9KSlcclxuICAgICAgICAub24oJ3BvaW50b3V0JywgKCkgPT4gbG9jYWxCdG4uc2V0U3R5bGUoe2ZpbGw6ICcjMWRkNjI3ZmYnfSkpXHJcbiAgICAgICAgLm9uKCdwb2ludGVyZG93bicsICgpID0+e1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLnN0YXJ0KCdHYW1lU2NlbmUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgUGFkZGxlIHtcblxuICAgIGNvbnN0cnVjdG9yKHNjZW5lLCBpZCwgeCwgeSkge1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMuc2NlbmUgPSBzY2VuZTtcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XG5cbiAgICAgICAgdGhpcy5iYXNlSGVpZ2h0ID0gMTAwO1xuICAgICAgICB0aGlzLmJhc2VXaWR0aCA9IDIwO1xuICAgICAgICB0aGlzLmJhc2VTcGVlZCA9IDMwMDtcblxuICAgICAgICBjb25zdCBncmFwaGljcyA9IHRoaXMuc2NlbmUuYWRkLmdyYXBoaWNzKCk7XG4gICAgICAgIGdyYXBoaWNzLmZpbGxTdHlsZSgweDAwZmYwMCk7XG4gICAgICAgIGdyYXBoaWNzLmZpbGxSZWN0KDAsIDAsIHRoaXMuYmFzZVdpZHRoLCB0aGlzLmJhc2VIZWlnaHQpO1xuICAgICAgICBncmFwaGljcy5nZW5lcmF0ZVRleHR1cmUoYHBhZGRsZS0ke2lkfWAsIHRoaXMuYmFzZVdpZHRoLCB0aGlzLmJhc2VIZWlnaHQpO1xuICAgICAgICBncmFwaGljcy5kZXN0cm95KCk7XG5cbiAgICAgICAgdGhpcy5zcHJpdGUgPSB0aGlzLnNjZW5lLnBoeXNpY3MuYWRkLnNwcml0ZSh4LCB5LCBgcGFkZGxlLSR7aWR9YCk7XG4gICAgICAgIHRoaXMuc3ByaXRlLnNldEltbW92YWJsZSh0cnVlKTtcbiAgICAgICAgdGhpcy5zcHJpdGUuc2V0Q29sbGlkZVdvcmxkQm91bmRzKHRydWUpO1xuICAgICAgICB0aGlzLnNwcml0ZS5ib2R5LmFsbG93R3Jhdml0eSA9IGZhbHNlO1xuICAgIH1cbn0iLCJpbXBvcnQgUGhhc2VyIGZyb20gXCJwaGFzZXJcIjtcclxuaW1wb3J0IHsgUGFkZGxlIH0gZnJvbSBcIi4uL2VudGl0aWVzL1BhZGRsZS5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVTY2VuZSBleHRlbmRzIFBoYXNlci5TY2VuZXtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCdHYW1lU2NlbmUnKVxyXG4gICAgfVxyXG5cclxuICAgIHByZWxvYWQoKXtcclxuICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2p1ZWdvJywgJ0Fzc2V0cy9qdWVnby5qcGcnKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIHRoaXMuYWRkLmltYWdlKDQwMCwgMzAwLCAnanVlZ28nKTtcclxuICAgICAgICB0aGlzLnBsYXllcnMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbnB1dHNNYXBwaW5nID0gW107XHJcbiAgICAgICAgdGhpcy5iYWxsID0gbnVsbDtcclxuICAgICAgICB0aGlzLmlzUGF1c2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5lc2NXYXNEb3duID0gZmFsc2U7XHJcbiAgICB9IFxyXG5cclxuICAgICByZXN1bWUoKXtcclxuICAgICAgICB0aGlzLmlzUGF1c2VkID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlKCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTc7aSsrKXtcclxuICAgICAgICAgICAgdGhpcy5hZGQucmVjdGFuZ2xlKDQwMCwgaSAqIDUwICsgMjUsIDEwLCAzMCwgMHhmZmZmZmYpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU2NvcmUgdGV4dHNcclxuICAgICAgICB0aGlzLnNjb3JlTGVmdCA9IHRoaXMuYWRkLnRleHQoMTAwLCA1MCwgJzAnLCB7XHJcbiAgICAgICAgICAgIGZvbnRTaXplOiAnNDhweCcsXHJcbiAgICAgICAgICAgIGNvbG9yOiAnIzAwZmYwMCdcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICB0aGlzLnNjb3JlUmlnaHQgPSB0aGlzLmFkZC50ZXh0KDcwMCwgNTAsICcwJywge1xyXG4gICAgICAgICAgICBmb250U2l6ZTogJzQ4cHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyMwMGZmMDAnXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLmNyZWF0ZUJvdW5kcygpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlQmFsbCgpO1xyXG4gICAgICAgIHRoaXMubGF1bmNoQmFsbCgpO1xyXG4gICAgICAgIHRoaXMuc2V0VXBQTGF5ZXJzKCk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKHBhZGRsZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGh5c2ljcy5hZGQuY29sbGlkZXIodGhpcy5iYWxsLCBwYWRkbGUuc3ByaXRlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5waHlzaWNzLmFkZC5vdmVybGFwKHRoaXMuYmFsbCwgdGhpcy5sZWZ0R29hbCwgdGhpcy5zY29yZVJpZ2h0R29hbCwgbnVsbCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzLmFkZC5vdmVybGFwKHRoaXMuYmFsbCwgdGhpcy5yaWdodEdvYWwsIHRoaXMuc2NvcmVMZWZ0R29hbCwgbnVsbCwgdGhpcyk7XHJcblxyXG4gICAgICAgIHRoaXMuZXNjS2V5PSB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXMuRVNDKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVcFBMYXllcnMoKSB7XHJcbiAgICAgICAgY29uc3QgbGVmdFBhZGRsZSA9IG5ldyBQYWRkbGUodGhpcywgJ3BsYXllcjEnLCA1MCwgMzAwKTtcclxuICAgICAgICBjb25zdCByaWdodFBhZGRsZSA9IG5ldyBQYWRkbGUodGhpcywgJ3BsYXllcjInLCA3NTAsIDMwMCk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJzLnNldCgncGxheWVyMScsIGxlZnRQYWRkbGUpO1xyXG4gICAgICAgIHRoaXMucGxheWVycy5zZXQoJ3BsYXllcjInLCByaWdodFBhZGRsZSk7XHJcblxyXG4gICAgICAgIGNvbnN0IElucHV0Q29uZmlnID0gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJJZDogJ3BsYXllcjEnLFxyXG4gICAgICAgICAgICAgICAgdXBLZXk6ICdXJyxcclxuICAgICAgICAgICAgICAgIGRvd25LZXk6ICdTJyxcclxuICAgICAgICAgICAgfSwgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBsYXllcklkOiAncGxheWVyMicsXHJcbiAgICAgICAgICAgICAgICB1cEtleTogJ1VQJyxcclxuICAgICAgICAgICAgICAgIGRvd25LZXk6ICdET1dOJyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgdGhpcy5pbnB1dHNNYXBwaW5nID0gSW5wdXRDb25maWc7XHJcbiAgICAgICAgdGhpcy5pbnB1dHNNYXBwaW5nID0gdGhpcy5pbnB1dHNNYXBwaW5nLm1hcChjb25maWcgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcGxheWVySWQ6IGNvbmZpZy5wbGF5ZXJJZCxcclxuICAgICAgICAgICAgICAgIHVwS2V5T2JqOiB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXNbY29uZmlnLnVwS2V5XSksXHJcbiAgICAgICAgICAgICAgICBkb3duS2V5T2JqOiB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXNbY29uZmlnLmRvd25LZXldKSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNjb3JlUmlnaHRHb2FsKCkge1xyXG4gICAgICAgIGNvbnN0IHBsYXllcjIgPSB0aGlzLnBsYXllcnMuZ2V0KCdwbGF5ZXIyJyk7XHJcbiAgICAgICAgcGxheWVyMi5zY29yZSArPSAxO1xyXG4gICAgICAgIHRoaXMuc2NvcmVSaWdodC5zZXRUZXh0KHBsYXllcjIuc2NvcmUudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgaWYgKHBsYXllcjIuc2NvcmUgPj0xMCl7XHJcbiAgICAgICAgICAgIHRoaXMuZW5kR2FtZSgncGxheWVyMicpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVzZXRCYWxsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2NvcmVMZWZ0R29hbCgpIHtcclxuICAgICAgICBjb25zdCBwbGF5ZXIxID0gdGhpcy5wbGF5ZXJzLmdldCgncGxheWVyMScpO1xyXG4gICAgICAgIHBsYXllcjEuc2NvcmUgKz0gMTtcclxuICAgICAgICB0aGlzLnNjb3JlTGVmdC5zZXRUZXh0KHBsYXllcjEuc2NvcmUudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgaWYgKHBsYXllcjEuc2NvcmUgPj0yKXtcclxuICAgICAgICAgICAgdGhpcy5lbmRHYW1lKCdwbGF5ZXIxJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZXNldEJhbGwoKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICByZXNldEJhbGwoKSB7XHJcbiAgICAgICAgdGhpcy5iYWxsLnNldFZlbG9jaXR5KDAsIDApO1xyXG4gICAgICAgIHRoaXMuYmFsbC5zZXRQb3NpdGlvbig0MDAsIDMwMCk7XHJcbiAgICAgICAgdGhpcy50aW1lLmRlbGF5ZWRDYWxsKDEwMDAsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5sYXVuY2hCYWxsKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQm91bmRzKCkge1xyXG4gICAgICAgIHRoaXMubGVmdEdvYWwgPSB0aGlzLnBoeXNpY3MuYWRkLnNwcml0ZSgwLCAzMDAsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubGVmdEdvYWwuc2V0RGlzcGxheVNpemUoMTAsIDYwMCk7XHJcbiAgICAgICAgdGhpcy5sZWZ0R29hbC5ib2R5LnNldFNpemUoMTAsIDYwMCk7XHJcbiAgICAgICAgdGhpcy5sZWZ0R29hbC5zZXRJbW1vdmFibGUoZmFsc2UpO1xyXG4gICAgICAgIHRoaXMubGVmdEdvYWwuc2V0VmlzaWJsZShmYWxzZSk7XHJcblxyXG4gICAgICAgIHRoaXMucmlnaHRHb2FsID0gdGhpcy5waHlzaWNzLmFkZC5zcHJpdGUoODAwLCAzMDAsIG51bGwpO1xyXG4gICAgICAgIHRoaXMucmlnaHRHb2FsLnNldERpc3BsYXlTaXplKDEwLCA2MDApO1xyXG4gICAgICAgIHRoaXMucmlnaHRHb2FsLmJvZHkuc2V0U2l6ZSgxMCwgNjAwKTtcclxuICAgICAgICB0aGlzLnJpZ2h0R29hbC5zZXRJbW1vdmFibGUoZmFsc2UpO1xyXG4gICAgICAgIHRoaXMucmlnaHRHb2FsLnNldFZpc2libGUoZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUJhbGwoKSB7XHJcbiAgICAgICAgY29uc3QgZ3JhcGhpY3MgPSB0aGlzLmFkZC5ncmFwaGljcygpO1xyXG4gICAgICAgIGdyYXBoaWNzLmZpbGxTdHlsZSgweGZmZmZmZik7XHJcbiAgICAgICAgZ3JhcGhpY3MuZmlsbENpcmNsZSg4LCA4LCA4KTtcclxuICAgICAgICBncmFwaGljcy5nZW5lcmF0ZVRleHR1cmUoJ2JhbGwnLCAxNiwgMTYpO1xyXG4gICAgICAgIGdyYXBoaWNzLmRlc3Ryb3koKTtcclxuXHJcbiAgICAgICAgdGhpcy5iYWxsID0gdGhpcy5waHlzaWNzLmFkZC5pbWFnZSg0MDAsIDMwMCwgJ2JhbGwnKTtcclxuICAgICAgICB0aGlzLmJhbGwuc2V0Q29sbGlkZVdvcmxkQm91bmRzKHRydWUpO1xyXG4gICAgICAgIHRoaXMuYmFsbC5zZXRCb3VuY2UoMSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGF1bmNoQmFsbCgpIHtcclxuICAgICAgICBjb25zdCBhbmdsZSA9IFBoYXNlci5NYXRoLkJldHdlZW4oLTMwLCAzMCk7XHJcbiAgICAgICAgY29uc3Qgc3BlZWQgPSA2MDA7XHJcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IDEgOiAtMTsgXHJcblxyXG4gICAgICAgIHRoaXMuYmFsbC5zZXRWZWxvY2l0eShcclxuICAgICAgICAgICAgTWF0aC5jb3MoUGhhc2VyLk1hdGguRGVnVG9SYWQoYW5nbGUpKSAqIHNwZWVkICogZGlyZWN0aW9uLFxyXG4gICAgICAgICAgICBNYXRoLnNpbihQaGFzZXIuTWF0aC5EZWdUb1JhZChhbmdsZSkpICogc3BlZWRcclxuICAgICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgZW5kR2FtZSh3aW5uZXJJZCl7XHJcbiAgICAgICAgdGhpcy5iYWxsLnNldFZlbG9jaXR5KDAsMCk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJzLmZvckVhY2gocGFkZGxlPT4ge1xyXG4gICAgICAgICAgICBwYWRkbGUuc3ByaXRlLnNldFZlbG9jaXR5KDAsMCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLnBoeXNpY3MucGF1c2UoKTtcclxuICAgICAgICBjb25zdCB3aW5uZXJUZXh0ID0gd2lubmVySWQ9PT0ncGxheWVyMSc/J0xlZnQgUGxheWVyIFdpbnMhISc6J1JpZ2h0IFBsYXllciBXaW5zISEnO1xyXG4gICAgICAgIHRoaXMuYWRkLnRleHQoNDAwLDI1MCwgd2lubmVyVGV4dCwge1xyXG4gICAgICAgICAgICBmb250U2l6ZTonNjRweCcsXHJcbiAgICAgICAgICAgIGNvbG9yOiAnIzAwZmYwMCdcclxuICAgICAgICB9KS5zZXRPcmlnaW4oMC41KTtcclxuXHJcbiAgICAgICAgY29uc3QgbWVudSA9IHRoaXMuYWRkLnRleHQoNDAwLDM1MCwnUmV0dXJuJyx7XHJcbiAgICAgICAgICAgIGZvbnRTaXplOiczMnB4JyxcclxuICAgICAgICAgICAgY29sb3I6ICcjMDBmZjAwJ1xyXG4gICAgICAgIH0pLnNldE9yaWdpbigwLjUpLnNldEludGVyYWN0aXZlKHt1c2VIYW5kQ3Vyc29yOnRydWV9KVxyXG4gICAgICAgIC5vbigncG9pbnRlcm92ZXInLCgpPT5tZW51LnNldENvbG9yKCcjZmYwMDAwJykpXHJcbiAgICAgICAgLm9uKCdwb2ludGVyb3V0JywoKT0+bWVudS5zZXRDb2xvcignIzAwZmYwMCcpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcmRvd24nLCAoKT0+e3RoaXMuc2NlbmUuc3RhcnQoJ01lbnVTY2VuZScpfSk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgdG9vZ2xlUGF1c2UoKXtcclxuICAgICAgICBjb25zdCBuZXdQYXVzZWRTdGF0ZSA9ICF0aGlzLmlzUGF1c2VkO1xyXG4gICAgICAgIHRoaXMuc2V0UGF1c2VTdGF0ZShuZXdQYXVzZWRTdGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0UGF1c2VTdGF0ZShpc1BhdXNlZCl7XHJcbiAgICAgICAgdGhpcy5pc1BhdXNlZCA9IGlzUGF1c2VkO1xyXG4gICAgICAgIGlmKGlzUGF1c2VkKXtcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5sYXVuY2goJ1BhdXNlU2NlbmUnLCB7b3JpZ2luYWxTY2VuZTonR2FtZVNjZW5lJ30pO1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLnBhdXNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUuc3RvcCgpOyAgXHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUucmVzdW1lKCdHYW1lU2NlbmUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKCl7XHJcbiAgICAgICAgaWYodGhpcy5lc2NLZXkuaXNEb3duKXtcclxuICAgICAgICAgICAgdGhpcy50b29nbGVQYXVzZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlucHV0c01hcHBpbmcuZm9yRWFjaChtYXBwaW5nID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcGFkZGxlID0gdGhpcy5wbGF5ZXJzLmdldChtYXBwaW5nLnBsYXllcklkKTtcclxuICAgICAgICAgICAgLy9sZXQgZGlyZWN0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKG1hcHBpbmcudXBLZXlPYmouaXNEb3duKXtcclxuICAgICAgICAgICAgICAgIHBhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHlZKC1wYWRkbGUuYmFzZVNwZWVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChtYXBwaW5nLmRvd25LZXlPYmouaXNEb3duKXtcclxuICAgICAgICAgICAgICAgIHBhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHlZKHBhZGRsZS5iYXNlU3BlZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge3BhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHlZKDApO31cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFBoYXNlciBmcm9tIFwicGhhc2VyXCI7XHJcbmV4cG9ydCBjbGFzcyBQYXVzZVNjZW5lIGV4dGVuZHMgUGhhc2VyLlNjZW5le1xyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICBzdXBlcignUGF1c2VTY2VuZScpO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlKGRhdGEpe1xyXG4gICAgICAgIHRoaXMuYWRkLnRleHQoNDAwLDE2MCwnUGF1c2VkJyx7XHJcbiAgICAgICAgICAgIGZvbnRTaXplOiAnNjRweCdcclxuICAgICAgICB9KS5zZXRPcmlnaW4oMC41KTtcclxuICAgICAgICBjb25zdCByZXN1bWVCdG4gPSB0aGlzLmFkZC50ZXh0KDQwMCwzMjAsICdSZXN1bWUnLHtcclxuICAgICAgICAgICAgZm9udFNpemU6JzYwcHgnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSkuc2V0SW50ZXJhY3RpdmUoe3VzZUhhbmRDdXJzb3I6dHJ1ZX0pXHJcbiAgICAgICAgLm9uKCdwb2ludGVyb3ZlcicsKCk9PnJlc3VtZUJ0bi5zZXRDb2xvcignI2ZmMDAwMCcpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcm91dCcsKCk9PnJlc3VtZUJ0bi5zZXRDb2xvcignIzAwZmYwMCcpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcmRvd24nLCAoKT0+e1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLnN0b3AoKTtcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5yZXN1bWUoZGF0YS5vcmlnaW5hbFNjZW5lKTtcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5nZXQoZGF0YS5vcmlnaW5hbFNjZW5lKS5yZXN1bWUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBob21lQnRuID0gdGhpcy5hZGQudGV4dCg0MDAsNTIwLCAnSG9tZScse1xyXG4gICAgICAgICAgICBmb250U2l6ZTonNjBweCdcclxuICAgICAgICB9KS5zZXRPcmlnaW4oMC41KS5zZXRJbnRlcmFjdGl2ZSh7dXNlSGFuZEN1cnNvcjp0cnVlfSlcclxuICAgICAgICAub24oJ3BvaW50ZXJvdmVyJywoKT0+aG9tZUJ0bi5zZXRDb2xvcignI2ZmMDAwMCcpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcm91dCcsKCk9PmhvbWVCdG4uc2V0Q29sb3IoJyMwMGZmMDAnKSlcclxuICAgICAgICAub24oJ3BvaW50ZXJkb3duJywgKCk9PntcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5zdG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUuc3RvcChkYXRhLm9yaWdpbmFsU2NlbmUpO1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLmxhdW5jaCgnTWVudVNjZW5lJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUGhhc2VyIGZyb20gJ3BoYXNlcic7XHJcblxyXG5pbXBvcnQgeyBNZW51U2NlbmUgfSBmcm9tICcuL3NjZW5lL01lbnVTY2VuZS5qcyc7XHJcbmltcG9ydCB7IEdhbWVTY2VuZSB9IGZyb20gJy4vc2NlbmUvR2FtZVNjZW5lLmpzJztcclxuaW1wb3J0IHsgUGF1c2VTY2VuZSB9IGZyb20gJy4vc2NlbmUvUGF1c2VTY2VuZS5qcyc7XHJcblxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgICB0eXBlOiBQaGFzZXIuQVVUTyxcclxuICAgIHdpZHRoOiA4MDAsXHJcbiAgICBoZWlnaHQ6IDYwMCxcclxuICAgIHBhcmVudDogJ2dhbWUtY29udGFpbmVyJyxcclxuICAgIHBoeXNpY3M6IHtcclxuICAgICAgICBkZWZhdWx0OiAnYXJjYWRlJyxcclxuICAgICAgICBhcmNhZGU6IHtcclxuICAgICAgICAgICAgZ3Jhdml0eToge3k6IDB9LFxyXG4gICAgICAgICAgICBkZWJ1ZzogZmFsc2VcclxuICAgICAgICB9IFxyXG4gICAgfSxcclxuXHJcbiAgICBzY2VuZTogW01lbnVTY2VuZSwgR2FtZVNjZW5lLCBQYXVzZVNjZW5lXSxcclxuICAgIGJhY2tncm91bmRDb2xvcjogJyMzNjAyNDZmZidcclxufVxyXG5cclxuY29uc3QgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZShjb25maWcpOyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlBoYXNlciIsIk1lbnVTY2VuZSIsImNvbnN0cnVjdG9yIiwic3VwZXIiLCJwcmVsb2FkIiwidGhpcyIsImxvYWQiLCJpbWFnZSIsImNyZWF0ZSIsImFkZCIsInRleHQiLCJmb250U2l6ZSIsImNvbG9yIiwic2V0T3JpZ2luIiwibG9jYWxCdG4iLCJzZXRJbnRlcmFjdGl2ZSIsInVzZUhhbmRDdXJzb3IiLCJvbiIsInNldFN0eWxlIiwiZmlsbCIsInNjZW5lIiwic3RhcnQiLCJQYWRkbGUiLCJpZCIsIngiLCJ5Iiwic2NvcmUiLCJiYXNlSGVpZ2h0IiwiYmFzZVdpZHRoIiwiYmFzZVNwZWVkIiwiZ3JhcGhpY3MiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsImdlbmVyYXRlVGV4dHVyZSIsImRlc3Ryb3kiLCJzcHJpdGUiLCJwaHlzaWNzIiwic2V0SW1tb3ZhYmxlIiwic2V0Q29sbGlkZVdvcmxkQm91bmRzIiwiYm9keSIsImFsbG93R3Jhdml0eSIsIkdhbWVTY2VuZSIsImluaXQiLCJwbGF5ZXJzIiwiTWFwIiwiaW5wdXRzTWFwcGluZyIsImJhbGwiLCJpc1BhdXNlZCIsImVzY1dhc0Rvd24iLCJyZXN1bWUiLCJpIiwicmVjdGFuZ2xlIiwic2NvcmVMZWZ0Iiwic2NvcmVSaWdodCIsImNyZWF0ZUJvdW5kcyIsImNyZWF0ZUJhbGwiLCJsYXVuY2hCYWxsIiwic2V0VXBQTGF5ZXJzIiwiZm9yRWFjaCIsInBhZGRsZSIsImNvbGxpZGVyIiwib3ZlcmxhcCIsImxlZnRHb2FsIiwic2NvcmVSaWdodEdvYWwiLCJyaWdodEdvYWwiLCJzY29yZUxlZnRHb2FsIiwiZXNjS2V5IiwiaW5wdXQiLCJrZXlib2FyZCIsImFkZEtleSIsIktleWJvYXJkIiwiS2V5Q29kZXMiLCJFU0MiLCJsZWZ0UGFkZGxlIiwicmlnaHRQYWRkbGUiLCJzZXQiLCJwbGF5ZXJJZCIsInVwS2V5IiwiZG93bktleSIsIm1hcCIsImNvbmZpZyIsInVwS2V5T2JqIiwiZG93bktleU9iaiIsInBsYXllcjIiLCJzZXRUZXh0IiwidG9TdHJpbmciLCJlbmRHYW1lIiwicmVzZXRCYWxsIiwicGxheWVyMSIsInNldFZlbG9jaXR5Iiwic2V0UG9zaXRpb24iLCJ0aW1lIiwiZGVsYXllZENhbGwiLCJzZXREaXNwbGF5U2l6ZSIsInNldFNpemUiLCJzZXRWaXNpYmxlIiwiZmlsbENpcmNsZSIsInNldEJvdW5jZSIsImFuZ2xlIiwiQmV0d2VlbiIsImRpcmVjdGlvbiIsIk1hdGgiLCJyYW5kb20iLCJjb3MiLCJEZWdUb1JhZCIsInNpbiIsIndpbm5lcklkIiwicGF1c2UiLCJ3aW5uZXJUZXh0IiwibWVudSIsInNldENvbG9yIiwidG9vZ2xlUGF1c2UiLCJuZXdQYXVzZWRTdGF0ZSIsInNldFBhdXNlU3RhdGUiLCJsYXVuY2giLCJvcmlnaW5hbFNjZW5lIiwic3RvcCIsInVwZGF0ZSIsImlzRG93biIsIm1hcHBpbmciLCJzZXRWZWxvY2l0eVkiLCJQYXVzZVNjZW5lIiwiZGF0YSIsInJlc3VtZUJ0biIsImhvbWVCdG4iLCJ0eXBlIiwid2lkdGgiLCJoZWlnaHQiLCJwYXJlbnQiLCJkZWZhdWx0IiwiYXJjYWRlIiwiZ3Jhdml0eSIsImRlYnVnIiwiYmFja2dyb3VuZENvbG9yIl0sInNvdXJjZVJvb3QiOiIifQ==