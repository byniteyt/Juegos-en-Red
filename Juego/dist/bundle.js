(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=Phaser;var s=e.n(t);class i extends s().Scene{constructor(){super("MenuScene")}preload(){this.load.image("fondo","Assets/MainMenu/inicio.jpg")}create(){this.add.image(400,300,"fondo"),this.add.text(400,100,"Charming Cats:\nGet-a-Home",{fontSize:"64px",color:"#ffffffff"}).setOrigin(.5);const e=this.add.text(400,300,"Local Play",{fontSize:"24px",color:"#1dd627ff"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointover",()=>e.setStyle({fill:"#e7b14dff"})).on("pointout",()=>e.setStyle({fill:"#1dd627ff"})).on("pointerdown",()=>{this.scene.start("GameScene")})}}class a{constructor(e,t,s,i,a){this.id=t,this.scene=e,this.score=0,this.baseHeight=100,this.baseWidth=20,this.baseSpeed=300,this.sprite=this.scene.physics.add.sprite(s,i,a),this.sprite.setImmovable(!0),this.sprite.setCollideWorldBounds(!0),this.sprite.body.allowGravity=!1}}class o extends s().Scene{constructor(){super("GameScene")}preload(){this.load.image("juego","Assets/Game/juego.jpg"),this.load.image("gato1","Assets/Game/Gatos jugables/PJCats_gato alegre.png"),this.load.image("gato2","Assets/Game/Gatos jugables/PJCats_gato negro.png")}init(){this.players=new Map,this.inputsMapping=[],this.ball=null,this.isPaused=!1,this.escWasDown=!1}resume(){this.isPaused=!1}create(){this.add.image(400,300,"juego");for(let e=0;e<17;e++)this.add.rectangle(400,50*e+25,10,30,16777215);this.scoreLeft=this.add.text(100,50,"0",{fontSize:"48px",color:"#00ff00"}),this.scoreRight=this.add.text(700,50,"0",{fontSize:"48px",color:"#00ff00"}),this.createBounds(),this.createBall(),this.launchBall(),this.setUpPLayers(),this.players.forEach(e=>{this.physics.add.collider(this.ball,e.sprite)}),this.physics.add.overlap(this.ball,this.leftGoal,this.scoreRightGoal,null,this),this.physics.add.overlap(this.ball,this.rightGoal,this.scoreLeftGoal,null,this),this.escKey=this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes.ESC)}setUpPLayers(){const e=new a(this,"player1",50,300,"gato1"),t=new a(this,"player2",750,300,"gato2");this.players.set("player1",e),this.players.set("player2",t),this.inputsMapping=[{playerId:"player1",upKey:"W",downKey:"S",leftKey:"A",rightKey:"D"},{playerId:"player2",upKey:"UP",downKey:"DOWN",leftKey:"LEFT",rightKey:"RIGHT"}],this.inputsMapping=this.inputsMapping.map(e=>({playerId:e.playerId,upKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.upKey]),downKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.downKey]),leftKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.leftKey]),rightKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.rightKey])}))}scoreRightGoal(){const e=this.players.get("player2");e.score+=1,this.scoreRight.setText(e.score.toString()),e.score>=10?this.endGame("player2"):this.resetBall()}scoreLeftGoal(){const e=this.players.get("player1");e.score+=1,this.scoreLeft.setText(e.score.toString()),e.score>=2?this.endGame("player1"):this.resetBall()}resetBall(){this.ball.setVelocity(0,0),this.ball.setPosition(400,300),this.time.delayedCall(1e3,()=>{this.launchBall()})}createBounds(){this.leftGoal=this.physics.add.sprite(0,700,null),this.leftGoal.setDisplaySize(10,600),this.leftGoal.body.setSize(10,600),this.leftGoal.setImmovable(!1),this.leftGoal.setVisible(!1),this.rightGoal=this.physics.add.sprite(1200,700,null),this.rightGoal.setDisplaySize(10,600),this.rightGoal.body.setSize(10,600),this.rightGoal.setImmovable(!1),this.rightGoal.setVisible(!1)}createBall(){const e=this.add.graphics();e.fillStyle(16777215),e.fillCircle(8,8,8),e.generateTexture("ball",16,16),e.destroy(),this.ball=this.physics.add.image(400,300,"ball"),this.ball.setCollideWorldBounds(!0),this.ball.setBounce(1)}launchBall(){const e=s().Math.Between(-30,30),t=Math.random()<.5?1:-1;this.ball.setVelocity(600*Math.cos(s().Math.DegToRad(e))*t,600*Math.sin(s().Math.DegToRad(e)))}endGame(e){this.ball.setVelocity(0,0),this.players.forEach(e=>{e.sprite.setVelocity(0,0)}),this.physics.pause();const t="player1"===e?"Left Player Wins!!":"Right Player Wins!!";this.add.text(400,250,t,{fontSize:"64px",color:"#00ff00"}).setOrigin(.5);const s=this.add.text(400,350,"Return",{fontSize:"32px",color:"#00ff00"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerover",()=>s.setColor("#ff0000")).on("pointerout",()=>s.setColor("#00ff00")).on("pointerdown",()=>{this.scene.start("MenuScene")})}tooglePause(){const e=!this.isPaused;this.setPauseState(e)}setPauseState(e){this.isPaused=e,e?(this.scene.launch("PauseScene",{originalScene:"GameScene"}),this.scene.pause()):(this.scene.stop(),this.scene.resume("GameScene"))}update(){this.escKey.isDown&&this.tooglePause(),this.inputsMapping.forEach(e=>{const t=this.players.get(e.playerId);e.upKeyObj.isDown?t.sprite.setVelocityY(-t.baseSpeed):e.downKeyObj.isDown?t.sprite.setVelocityY(t.baseSpeed):t.sprite.setVelocityY(0),e.leftKeyObj.isDown?t.sprite.setVelocityX(-t.baseSpeed):e.rightKeyObj.isDown?t.sprite.setVelocityX(t.baseSpeed):t.sprite.setVelocityX(0)})}}class r extends s().Scene{constructor(){super("PauseScene")}create(e){this.add.text(400,160,"Paused",{fontSize:"64px"}).setOrigin(.5);const t=this.add.text(400,320,"Resume",{fontSize:"60px"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerover",()=>t.setColor("#ff0000")).on("pointerout",()=>t.setColor("#00ff00")).on("pointerdown",()=>{this.scene.stop(),this.scene.resume(e.originalScene),this.scene.get(e.originalScene).resume()}),s=this.add.text(400,520,"Home",{fontSize:"60px"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerover",()=>s.setColor("#ff0000")).on("pointerout",()=>s.setColor("#00ff00")).on("pointerdown",()=>{this.scene.stop(),this.scene.stop(e.originalScene),this.scene.launch("MenuScene")})}}const l={type:s().AUTO,width:1200,height:700,parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[i,o,r],backgroundColor:"#360246ff"};new(s().Game)(l)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VkUsVUFBVSxJQUFLRSxlQUFlLENBQUNDLGVBQWMsSUFDL0NDLEdBQUcsY0FBYyxJQUFJOEcsRUFBVWQsU0FBUyxZQUN4Q2hHLEdBQUcsYUFBYSxJQUFJOEcsRUFBVWQsU0FBUyxZQUN2Q2hHLEdBQUcsY0FBZSxLQUNmWixLQUFLZSxNQUFNbUcsT0FDWGxILEtBQUtlLE1BQU15QixPQUFPaUYsRUFBS1IsZUFDdkJqSCxLQUFLZSxNQUFNMUIsSUFBSW9JLEVBQUtSLGVBQWV6RSxXQUVqQ21GLEVBQVUzSCxLQUFLSSxJQUFJQyxLQUFLLElBQUksSUFBSyxPQUFPLENBQzFDQyxTQUFTLFNBQ1ZFLFVBQVUsSUFBS0UsZUFBZSxDQUFDQyxlQUFjLElBQy9DQyxHQUFHLGNBQWMsSUFBSStHLEVBQVFmLFNBQVMsWUFDdENoRyxHQUFHLGFBQWEsSUFBSStHLEVBQVFmLFNBQVMsWUFDckNoRyxHQUFHLGNBQWUsS0FDZlosS0FBS2UsTUFBTW1HLE9BQ1hsSCxLQUFLZSxNQUFNbUcsS0FBS08sRUFBS1IsZUFDckJqSCxLQUFLZSxNQUFNaUcsT0FBTyxjQUUxQixFQ3ZCSixNQUFNdkMsRUFBUyxDQUNYbUQsS0FBTSxTQUNOQyxNQUFPLEtBQ1BDLE9BQVEsSUFDUkMsT0FBUSxpQkFDUnBHLFFBQVMsQ0FDTHFHLFFBQVMsU0FDVEMsT0FBUSxDQUNKQyxRQUFTLENBQUM5RyxFQUFHLEdBQ2IrRyxPQUFPLElBSWZwSCxNQUFPLENBQUNuQixFQUFXb0MsRUFBV3dGLEdBQzlCWSxnQkFBaUIsYUFHUixJQUFJLFVBQVkzRCxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY2Uvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcHJhY3RpY2Uvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vcHJhY3RpY2Uvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3ByYWN0aWNlL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvZXh0ZXJuYWwgdmFyIFwiUGhhc2VyXCIiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvc2NlbmUvTWVudVNjZW5lLmpzIiwid2VicGFjazovL3ByYWN0aWNlLy4vc3JjL2VudGl0aWVzL0NhdC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9zY2VuZS9HYW1lU2NlbmUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvc2NlbmUvUGF1c2VTY2VuZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9tYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gUGhhc2VyOyIsImltcG9ydCBQaGFzZXIgZnJvbSBcInBoYXNlclwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1lbnVTY2VuZSBleHRlbmRzIFBoYXNlci5TY2VuZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcignTWVudVNjZW5lJylcclxuICAgIH1cclxuXHJcbiAgICBwcmVsb2FkKCl7XHJcbiAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdmb25kbycsICdBc3NldHMvTWFpbk1lbnUvaW5pY2lvLmpwZycpO1xyXG4gICAgfVxyXG4gICBcclxuICAgIGNyZWF0ZSgpIHtcclxuICAgICAgICB0aGlzLmFkZC5pbWFnZSg0MDAsIDMwMCwgJ2ZvbmRvJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5hZGQudGV4dCg0MDAsMTAwLCAnQ2hhcm1pbmcgQ2F0czpcXG5HZXQtYS1Ib21lJyxcclxuICAgICAgICB7ICAgZm9udFNpemU6ICc2NHB4JyxcclxuICAgICAgICAgICAgY29sb3I6ICcjZmZmZmZmZmYnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGxvY2FsQnRuID0gdGhpcy5hZGQudGV4dCg0MDAsIDMwMCwgJ0xvY2FsIFBsYXknLCB7XHJcbiAgICAgICAgICAgIGZvbnRTaXplOiAnMjRweCcsIGNvbG9yOiAnIzFkZDYyN2ZmJ1xyXG4gICAgICAgIH0pLnNldE9yaWdpbigwLjUpXHJcbiAgICAgICAgLnNldEludGVyYWN0aXZlKHt1c2VIYW5kQ3Vyc29yOiB0cnVlfSlcclxuICAgICAgICAub24oJ3BvaW50b3ZlcicsICgpID0+IGxvY2FsQnRuLnNldFN0eWxlKHtmaWxsOiAnI2U3YjE0ZGZmJ30pKVxyXG4gICAgICAgIC5vbigncG9pbnRvdXQnLCAoKSA9PiBsb2NhbEJ0bi5zZXRTdHlsZSh7ZmlsbDogJyMxZGQ2MjdmZid9KSlcclxuICAgICAgICAub24oJ3BvaW50ZXJkb3duJywgKCkgPT57XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUuc3RhcnQoJ0dhbWVTY2VuZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBDYXQge1xuXG4gICAgY29uc3RydWN0b3Ioc2NlbmUsIGlkLCB4LCB5LCBkaXJlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLnNjZW5lID0gc2NlbmU7XG4gICAgICAgIHRoaXMuc2NvcmUgPSAwO1xuXG4gICAgICAgIHRoaXMuYmFzZUhlaWdodCA9IDEwMDtcbiAgICAgICAgdGhpcy5iYXNlV2lkdGggPSAyMDtcbiAgICAgICAgdGhpcy5iYXNlU3BlZWQgPSAzMDA7XG5cblxuICAgICAgICB0aGlzLnNwcml0ZSA9IHRoaXMuc2NlbmUucGh5c2ljcy5hZGQuc3ByaXRlKHgsIHksIGRpcmVjdGlvbik7XG4gICAgICAgIHRoaXMuc3ByaXRlLnNldEltbW92YWJsZSh0cnVlKTtcbiAgICAgICAgdGhpcy5zcHJpdGUuc2V0Q29sbGlkZVdvcmxkQm91bmRzKHRydWUpO1xuICAgICAgICB0aGlzLnNwcml0ZS5ib2R5LmFsbG93R3Jhdml0eSA9IGZhbHNlO1xuICAgIH1cbn0iLCJpbXBvcnQgUGhhc2VyIGZyb20gXCJwaGFzZXJcIjtcclxuaW1wb3J0IHsgQ2F0IH0gZnJvbSBcIi4uL2VudGl0aWVzL0NhdC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVTY2VuZSBleHRlbmRzIFBoYXNlci5TY2VuZXtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCdHYW1lU2NlbmUnKVxyXG4gICAgfVxyXG5cclxuICAgIHByZWxvYWQoKXtcclxuICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2p1ZWdvJywgJ0Fzc2V0cy9HYW1lL2p1ZWdvLmpwZycpO1xyXG4gICAgICAgIHRoaXMubG9hZC5pbWFnZSgnZ2F0bzEnLCAnQXNzZXRzL0dhbWUvR2F0b3MganVnYWJsZXMvUEpDYXRzX2dhdG8gYWxlZ3JlLnBuZycpO1xyXG4gICAgICAgIHRoaXMubG9hZC5pbWFnZSgnZ2F0bzInLCAnQXNzZXRzL0dhbWUvR2F0b3MganVnYWJsZXMvUEpDYXRzX2dhdG8gbmVncm8ucG5nJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICB0aGlzLnBsYXllcnMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbnB1dHNNYXBwaW5nID0gW107XHJcbiAgICAgICAgdGhpcy5iYWxsID0gbnVsbDtcclxuICAgICAgICB0aGlzLmlzUGF1c2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5lc2NXYXNEb3duID0gZmFsc2U7XHJcbiAgICB9IFxyXG5cclxuICAgICByZXN1bWUoKXtcclxuICAgICAgICB0aGlzLmlzUGF1c2VkID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlKCkge1xyXG4gICAgICAgIHRoaXMuYWRkLmltYWdlKDQwMCwgMzAwLCAnanVlZ28nKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE3O2krKyl7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkLnJlY3RhbmdsZSg0MDAsIGkgKiA1MCArIDI1LCAxMCwgMzAsIDB4ZmZmZmZmKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNjb3JlIHRleHRzXHJcbiAgICAgICAgdGhpcy5zY29yZUxlZnQgPSB0aGlzLmFkZC50ZXh0KDEwMCwgNTAsICcwJywge1xyXG4gICAgICAgICAgICBmb250U2l6ZTogJzQ4cHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyMwMGZmMDAnXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdGhpcy5zY29yZVJpZ2h0ID0gdGhpcy5hZGQudGV4dCg3MDAsIDUwLCAnMCcsIHtcclxuICAgICAgICAgICAgZm9udFNpemU6ICc0OHB4JyxcclxuICAgICAgICAgICAgY29sb3I6ICcjMDBmZjAwJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5jcmVhdGVCb3VuZHMoKTtcclxuICAgICAgICB0aGlzLmNyZWF0ZUJhbGwoKTtcclxuICAgICAgICB0aGlzLmxhdW5jaEJhbGwoKTtcclxuICAgICAgICB0aGlzLnNldFVwUExheWVycygpO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaChwYWRkbGUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBoeXNpY3MuYWRkLmNvbGxpZGVyKHRoaXMuYmFsbCwgcGFkZGxlLnNwcml0ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMucGh5c2ljcy5hZGQub3ZlcmxhcCh0aGlzLmJhbGwsIHRoaXMubGVmdEdvYWwsIHRoaXMuc2NvcmVSaWdodEdvYWwsIG51bGwsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMucGh5c2ljcy5hZGQub3ZlcmxhcCh0aGlzLmJhbGwsIHRoaXMucmlnaHRHb2FsLCB0aGlzLnNjb3JlTGVmdEdvYWwsIG51bGwsIHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLmVzY0tleT0gdGhpcy5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLklucHV0LktleWJvYXJkLktleUNvZGVzLkVTQyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXBQTGF5ZXJzKCkge1xyXG4gICAgICAgIGNvbnN0IGxlZnRQYWRkbGUgPSBuZXcgQ2F0KHRoaXMsICdwbGF5ZXIxJywgNTAsIDMwMCwnZ2F0bzEnKTtcclxuICAgICAgICBjb25zdCByaWdodFBhZGRsZSA9IG5ldyBDYXQodGhpcywgJ3BsYXllcjInLCA3NTAsIDMwMCwgJ2dhdG8yJyk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJzLnNldCgncGxheWVyMScsIGxlZnRQYWRkbGUpO1xyXG4gICAgICAgIHRoaXMucGxheWVycy5zZXQoJ3BsYXllcjInLCByaWdodFBhZGRsZSk7XHJcblxyXG4gICAgICAgIGNvbnN0IElucHV0Q29uZmlnID0gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJJZDogJ3BsYXllcjEnLFxyXG4gICAgICAgICAgICAgICAgdXBLZXk6ICdXJyxcclxuICAgICAgICAgICAgICAgIGRvd25LZXk6ICdTJyxcclxuICAgICAgICAgICAgICAgIGxlZnRLZXk6ICdBJyxcclxuICAgICAgICAgICAgICAgIHJpZ2h0S2V5OiAnRCdcclxuICAgICAgICAgICAgfSwgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBsYXllcklkOiAncGxheWVyMicsXHJcbiAgICAgICAgICAgICAgICB1cEtleTogJ1VQJyxcclxuICAgICAgICAgICAgICAgIGRvd25LZXk6ICdET1dOJyxcclxuICAgICAgICAgICAgICAgIGxlZnRLZXk6ICdMRUZUJyxcclxuICAgICAgICAgICAgICAgIHJpZ2h0S2V5OiAnUklHSFQnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIHRoaXMuaW5wdXRzTWFwcGluZyA9IElucHV0Q29uZmlnO1xyXG4gICAgICAgIHRoaXMuaW5wdXRzTWFwcGluZyA9IHRoaXMuaW5wdXRzTWFwcGluZy5tYXAoY29uZmlnID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHBsYXllcklkOiBjb25maWcucGxheWVySWQsXHJcbiAgICAgICAgICAgICAgICB1cEtleU9iajogdGhpcy5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLklucHV0LktleWJvYXJkLktleUNvZGVzW2NvbmZpZy51cEtleV0pLFxyXG4gICAgICAgICAgICAgICAgZG93bktleU9iajogdGhpcy5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLklucHV0LktleWJvYXJkLktleUNvZGVzW2NvbmZpZy5kb3duS2V5XSksXHJcbiAgICAgICAgICAgICAgICBsZWZ0S2V5T2JqOiB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXNbY29uZmlnLmxlZnRLZXldKSxcclxuICAgICAgICAgICAgICAgIHJpZ2h0S2V5T2JqOiB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXNbY29uZmlnLnJpZ2h0S2V5XSksXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzY29yZVJpZ2h0R29hbCgpIHtcclxuICAgICAgICBjb25zdCBwbGF5ZXIyID0gdGhpcy5wbGF5ZXJzLmdldCgncGxheWVyMicpO1xyXG4gICAgICAgIHBsYXllcjIuc2NvcmUgKz0gMTtcclxuICAgICAgICB0aGlzLnNjb3JlUmlnaHQuc2V0VGV4dChwbGF5ZXIyLnNjb3JlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGlmIChwbGF5ZXIyLnNjb3JlID49MTApe1xyXG4gICAgICAgICAgICB0aGlzLmVuZEdhbWUoJ3BsYXllcjInKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlc2V0QmFsbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNjb3JlTGVmdEdvYWwoKSB7XHJcbiAgICAgICAgY29uc3QgcGxheWVyMSA9IHRoaXMucGxheWVycy5nZXQoJ3BsYXllcjEnKTtcclxuICAgICAgICBwbGF5ZXIxLnNjb3JlICs9IDE7XHJcbiAgICAgICAgdGhpcy5zY29yZUxlZnQuc2V0VGV4dChwbGF5ZXIxLnNjb3JlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGlmIChwbGF5ZXIxLnNjb3JlID49Mil7XHJcbiAgICAgICAgICAgIHRoaXMuZW5kR2FtZSgncGxheWVyMScpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVzZXRCYWxsKCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRCYWxsKCkge1xyXG4gICAgICAgIHRoaXMuYmFsbC5zZXRWZWxvY2l0eSgwLCAwKTtcclxuICAgICAgICB0aGlzLmJhbGwuc2V0UG9zaXRpb24oNDAwLCAzMDApO1xyXG4gICAgICAgIHRoaXMudGltZS5kZWxheWVkQ2FsbCgxMDAwLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMubGF1bmNoQmFsbCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUJvdW5kcygpIHtcclxuICAgICAgICB0aGlzLmxlZnRHb2FsID0gdGhpcy5waHlzaWNzLmFkZC5zcHJpdGUoMCwgNzAwLCBudWxsKTtcclxuICAgICAgICB0aGlzLmxlZnRHb2FsLnNldERpc3BsYXlTaXplKDEwLCA2MDApO1xyXG4gICAgICAgIHRoaXMubGVmdEdvYWwuYm9keS5zZXRTaXplKDEwLCA2MDApO1xyXG4gICAgICAgIHRoaXMubGVmdEdvYWwuc2V0SW1tb3ZhYmxlKGZhbHNlKTtcclxuICAgICAgICB0aGlzLmxlZnRHb2FsLnNldFZpc2libGUoZmFsc2UpO1xyXG5cclxuICAgICAgICB0aGlzLnJpZ2h0R29hbCA9IHRoaXMucGh5c2ljcy5hZGQuc3ByaXRlKDEyMDAsIDcwMCwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5yaWdodEdvYWwuc2V0RGlzcGxheVNpemUoMTAsIDYwMCk7XHJcbiAgICAgICAgdGhpcy5yaWdodEdvYWwuYm9keS5zZXRTaXplKDEwLCA2MDApO1xyXG4gICAgICAgIHRoaXMucmlnaHRHb2FsLnNldEltbW92YWJsZShmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5yaWdodEdvYWwuc2V0VmlzaWJsZShmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQmFsbCgpIHtcclxuICAgICAgICBjb25zdCBncmFwaGljcyA9IHRoaXMuYWRkLmdyYXBoaWNzKCk7XHJcbiAgICAgICAgZ3JhcGhpY3MuZmlsbFN0eWxlKDB4ZmZmZmZmKTtcclxuICAgICAgICBncmFwaGljcy5maWxsQ2lyY2xlKDgsIDgsIDgpO1xyXG4gICAgICAgIGdyYXBoaWNzLmdlbmVyYXRlVGV4dHVyZSgnYmFsbCcsIDE2LCAxNik7XHJcbiAgICAgICAgZ3JhcGhpY3MuZGVzdHJveSgpO1xyXG5cclxuICAgICAgICB0aGlzLmJhbGwgPSB0aGlzLnBoeXNpY3MuYWRkLmltYWdlKDQwMCwgMzAwLCAnYmFsbCcpO1xyXG4gICAgICAgIHRoaXMuYmFsbC5zZXRDb2xsaWRlV29ybGRCb3VuZHModHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5iYWxsLnNldEJvdW5jZSgxKTtcclxuICAgIH1cclxuXHJcbiAgICBsYXVuY2hCYWxsKCkge1xyXG4gICAgICAgIGNvbnN0IGFuZ2xlID0gUGhhc2VyLk1hdGguQmV0d2VlbigtMzAsIDMwKTtcclxuICAgICAgICBjb25zdCBzcGVlZCA9IDYwMDtcclxuICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gMSA6IC0xOyBcclxuXHJcbiAgICAgICAgdGhpcy5iYWxsLnNldFZlbG9jaXR5KFxyXG4gICAgICAgICAgICBNYXRoLmNvcyhQaGFzZXIuTWF0aC5EZWdUb1JhZChhbmdsZSkpICogc3BlZWQgKiBkaXJlY3Rpb24sXHJcbiAgICAgICAgICAgIE1hdGguc2luKFBoYXNlci5NYXRoLkRlZ1RvUmFkKGFuZ2xlKSkgKiBzcGVlZFxyXG4gICAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBlbmRHYW1lKHdpbm5lcklkKXtcclxuICAgICAgICB0aGlzLmJhbGwuc2V0VmVsb2NpdHkoMCwwKTtcclxuICAgICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaChwYWRkbGU9PiB7XHJcbiAgICAgICAgICAgIHBhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHkoMCwwKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMucGh5c2ljcy5wYXVzZSgpO1xyXG4gICAgICAgIGNvbnN0IHdpbm5lclRleHQgPSB3aW5uZXJJZD09PSdwbGF5ZXIxJz8nTGVmdCBQbGF5ZXIgV2lucyEhJzonUmlnaHQgUGxheWVyIFdpbnMhISc7XHJcbiAgICAgICAgdGhpcy5hZGQudGV4dCg0MDAsMjUwLCB3aW5uZXJUZXh0LCB7XHJcbiAgICAgICAgICAgIGZvbnRTaXplOic2NHB4JyxcclxuICAgICAgICAgICAgY29sb3I6ICcjMDBmZjAwJ1xyXG4gICAgICAgIH0pLnNldE9yaWdpbigwLjUpO1xyXG5cclxuICAgICAgICBjb25zdCBtZW51ID0gdGhpcy5hZGQudGV4dCg0MDAsMzUwLCdSZXR1cm4nLHtcclxuICAgICAgICAgICAgZm9udFNpemU6JzMycHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyMwMGZmMDAnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSkuc2V0SW50ZXJhY3RpdmUoe3VzZUhhbmRDdXJzb3I6dHJ1ZX0pXHJcbiAgICAgICAgLm9uKCdwb2ludGVyb3ZlcicsKCk9Pm1lbnUuc2V0Q29sb3IoJyNmZjAwMDAnKSlcclxuICAgICAgICAub24oJ3BvaW50ZXJvdXQnLCgpPT5tZW51LnNldENvbG9yKCcjMDBmZjAwJykpXHJcbiAgICAgICAgLm9uKCdwb2ludGVyZG93bicsICgpPT57dGhpcy5zY2VuZS5zdGFydCgnTWVudVNjZW5lJyl9KTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICB0b29nbGVQYXVzZSgpe1xyXG4gICAgICAgIGNvbnN0IG5ld1BhdXNlZFN0YXRlID0gIXRoaXMuaXNQYXVzZWQ7XHJcbiAgICAgICAgdGhpcy5zZXRQYXVzZVN0YXRlKG5ld1BhdXNlZFN0YXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRQYXVzZVN0YXRlKGlzUGF1c2VkKXtcclxuICAgICAgICB0aGlzLmlzUGF1c2VkID0gaXNQYXVzZWQ7XHJcbiAgICAgICAgaWYoaXNQYXVzZWQpe1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLmxhdW5jaCgnUGF1c2VTY2VuZScsIHtvcmlnaW5hbFNjZW5lOidHYW1lU2NlbmUnfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUucGF1c2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5zdG9wKCk7ICBcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5yZXN1bWUoJ0dhbWVTY2VuZScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUoKXtcclxuICAgICAgICBpZih0aGlzLmVzY0tleS5pc0Rvd24pe1xyXG4gICAgICAgICAgICB0aGlzLnRvb2dsZVBhdXNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5wdXRzTWFwcGluZy5mb3JFYWNoKG1hcHBpbmcgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYWRkbGUgPSB0aGlzLnBsYXllcnMuZ2V0KG1hcHBpbmcucGxheWVySWQpO1xyXG4gICAgICAgICAgICAvL2xldCBkaXJlY3Rpb24gPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAobWFwcGluZy51cEtleU9iai5pc0Rvd24pe1xyXG4gICAgICAgICAgICAgICAgcGFkZGxlLnNwcml0ZS5zZXRWZWxvY2l0eVkoLXBhZGRsZS5iYXNlU3BlZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG1hcHBpbmcuZG93bktleU9iai5pc0Rvd24pe1xyXG4gICAgICAgICAgICAgICAgcGFkZGxlLnNwcml0ZS5zZXRWZWxvY2l0eVkocGFkZGxlLmJhc2VTcGVlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7cGFkZGxlLnNwcml0ZS5zZXRWZWxvY2l0eVkoMCk7fVxyXG5cclxuICAgICAgICAgICAgaWYgKG1hcHBpbmcubGVmdEtleU9iai5pc0Rvd24pe1xyXG4gICAgICAgICAgICAgICAgcGFkZGxlLnNwcml0ZS5zZXRWZWxvY2l0eVgoLXBhZGRsZS5iYXNlU3BlZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG1hcHBpbmcucmlnaHRLZXlPYmouaXNEb3duKXtcclxuICAgICAgICAgICAgICAgIHBhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHlYKHBhZGRsZS5iYXNlU3BlZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge3BhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHlYKDApO31cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFBoYXNlciBmcm9tIFwicGhhc2VyXCI7XHJcbmV4cG9ydCBjbGFzcyBQYXVzZVNjZW5lIGV4dGVuZHMgUGhhc2VyLlNjZW5le1xyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICBzdXBlcignUGF1c2VTY2VuZScpO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlKGRhdGEpe1xyXG4gICAgICAgIHRoaXMuYWRkLnRleHQoNDAwLDE2MCwnUGF1c2VkJyx7XHJcbiAgICAgICAgICAgIGZvbnRTaXplOiAnNjRweCdcclxuICAgICAgICB9KS5zZXRPcmlnaW4oMC41KTtcclxuICAgICAgICBjb25zdCByZXN1bWVCdG4gPSB0aGlzLmFkZC50ZXh0KDQwMCwzMjAsICdSZXN1bWUnLHtcclxuICAgICAgICAgICAgZm9udFNpemU6JzYwcHgnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSkuc2V0SW50ZXJhY3RpdmUoe3VzZUhhbmRDdXJzb3I6dHJ1ZX0pXHJcbiAgICAgICAgLm9uKCdwb2ludGVyb3ZlcicsKCk9PnJlc3VtZUJ0bi5zZXRDb2xvcignI2ZmMDAwMCcpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcm91dCcsKCk9PnJlc3VtZUJ0bi5zZXRDb2xvcignIzAwZmYwMCcpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcmRvd24nLCAoKT0+e1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLnN0b3AoKTtcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5yZXN1bWUoZGF0YS5vcmlnaW5hbFNjZW5lKTtcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5nZXQoZGF0YS5vcmlnaW5hbFNjZW5lKS5yZXN1bWUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBob21lQnRuID0gdGhpcy5hZGQudGV4dCg0MDAsNTIwLCAnSG9tZScse1xyXG4gICAgICAgICAgICBmb250U2l6ZTonNjBweCdcclxuICAgICAgICB9KS5zZXRPcmlnaW4oMC41KS5zZXRJbnRlcmFjdGl2ZSh7dXNlSGFuZEN1cnNvcjp0cnVlfSlcclxuICAgICAgICAub24oJ3BvaW50ZXJvdmVyJywoKT0+aG9tZUJ0bi5zZXRDb2xvcignI2ZmMDAwMCcpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcm91dCcsKCk9PmhvbWVCdG4uc2V0Q29sb3IoJyMwMGZmMDAnKSlcclxuICAgICAgICAub24oJ3BvaW50ZXJkb3duJywgKCk9PntcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5zdG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUuc3RvcChkYXRhLm9yaWdpbmFsU2NlbmUpO1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLmxhdW5jaCgnTWVudVNjZW5lJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUGhhc2VyIGZyb20gJ3BoYXNlcic7XHJcblxyXG5pbXBvcnQgeyBNZW51U2NlbmUgfSBmcm9tICcuL3NjZW5lL01lbnVTY2VuZS5qcyc7XHJcbmltcG9ydCB7IEdhbWVTY2VuZSB9IGZyb20gJy4vc2NlbmUvR2FtZVNjZW5lLmpzJztcclxuaW1wb3J0IHsgUGF1c2VTY2VuZSB9IGZyb20gJy4vc2NlbmUvUGF1c2VTY2VuZS5qcyc7XHJcblxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgICB0eXBlOiBQaGFzZXIuQVVUTyxcclxuICAgIHdpZHRoOiAxMjAwLFxyXG4gICAgaGVpZ2h0OiA3MDAsXHJcbiAgICBwYXJlbnQ6ICdnYW1lLWNvbnRhaW5lcicsXHJcbiAgICBwaHlzaWNzOiB7XHJcbiAgICAgICAgZGVmYXVsdDogJ2FyY2FkZScsXHJcbiAgICAgICAgYXJjYWRlOiB7XHJcbiAgICAgICAgICAgIGdyYXZpdHk6IHt5OiAwfSxcclxuICAgICAgICAgICAgZGVidWc6IGZhbHNlXHJcbiAgICAgICAgfSBcclxuICAgIH0sXHJcblxyXG4gICAgc2NlbmU6IFtNZW51U2NlbmUsIEdhbWVTY2VuZSwgUGF1c2VTY2VuZV0sXHJcbiAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjMzYwMjQ2ZmYnXHJcbn1cclxuXHJcbmNvbnN0IGdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoY29uZmlnKTsiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZSIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkIiwiYSIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJQaGFzZXIiLCJNZW51U2NlbmUiLCJjb25zdHJ1Y3RvciIsInN1cGVyIiwicHJlbG9hZCIsInRoaXMiLCJsb2FkIiwiaW1hZ2UiLCJjcmVhdGUiLCJhZGQiLCJ0ZXh0IiwiZm9udFNpemUiLCJjb2xvciIsInNldE9yaWdpbiIsImxvY2FsQnRuIiwic2V0SW50ZXJhY3RpdmUiLCJ1c2VIYW5kQ3Vyc29yIiwib24iLCJzZXRTdHlsZSIsImZpbGwiLCJzY2VuZSIsInN0YXJ0IiwiQ2F0IiwiaWQiLCJ4IiwieSIsImRpcmVjdGlvbiIsInNjb3JlIiwiYmFzZUhlaWdodCIsImJhc2VXaWR0aCIsImJhc2VTcGVlZCIsInNwcml0ZSIsInBoeXNpY3MiLCJzZXRJbW1vdmFibGUiLCJzZXRDb2xsaWRlV29ybGRCb3VuZHMiLCJib2R5IiwiYWxsb3dHcmF2aXR5IiwiR2FtZVNjZW5lIiwiaW5pdCIsInBsYXllcnMiLCJNYXAiLCJpbnB1dHNNYXBwaW5nIiwiYmFsbCIsImlzUGF1c2VkIiwiZXNjV2FzRG93biIsInJlc3VtZSIsImkiLCJyZWN0YW5nbGUiLCJzY29yZUxlZnQiLCJzY29yZVJpZ2h0IiwiY3JlYXRlQm91bmRzIiwiY3JlYXRlQmFsbCIsImxhdW5jaEJhbGwiLCJzZXRVcFBMYXllcnMiLCJmb3JFYWNoIiwicGFkZGxlIiwiY29sbGlkZXIiLCJvdmVybGFwIiwibGVmdEdvYWwiLCJzY29yZVJpZ2h0R29hbCIsInJpZ2h0R29hbCIsInNjb3JlTGVmdEdvYWwiLCJlc2NLZXkiLCJpbnB1dCIsImtleWJvYXJkIiwiYWRkS2V5IiwiS2V5Ym9hcmQiLCJLZXlDb2RlcyIsIkVTQyIsImxlZnRQYWRkbGUiLCJyaWdodFBhZGRsZSIsInNldCIsInBsYXllcklkIiwidXBLZXkiLCJkb3duS2V5IiwibGVmdEtleSIsInJpZ2h0S2V5IiwibWFwIiwiY29uZmlnIiwidXBLZXlPYmoiLCJkb3duS2V5T2JqIiwibGVmdEtleU9iaiIsInJpZ2h0S2V5T2JqIiwicGxheWVyMiIsInNldFRleHQiLCJ0b1N0cmluZyIsImVuZEdhbWUiLCJyZXNldEJhbGwiLCJwbGF5ZXIxIiwic2V0VmVsb2NpdHkiLCJzZXRQb3NpdGlvbiIsInRpbWUiLCJkZWxheWVkQ2FsbCIsInNldERpc3BsYXlTaXplIiwic2V0U2l6ZSIsInNldFZpc2libGUiLCJncmFwaGljcyIsImZpbGxTdHlsZSIsImZpbGxDaXJjbGUiLCJnZW5lcmF0ZVRleHR1cmUiLCJkZXN0cm95Iiwic2V0Qm91bmNlIiwiYW5nbGUiLCJCZXR3ZWVuIiwiTWF0aCIsInJhbmRvbSIsImNvcyIsIkRlZ1RvUmFkIiwic2luIiwid2lubmVySWQiLCJwYXVzZSIsIndpbm5lclRleHQiLCJtZW51Iiwic2V0Q29sb3IiLCJ0b29nbGVQYXVzZSIsIm5ld1BhdXNlZFN0YXRlIiwic2V0UGF1c2VTdGF0ZSIsImxhdW5jaCIsIm9yaWdpbmFsU2NlbmUiLCJzdG9wIiwidXBkYXRlIiwiaXNEb3duIiwibWFwcGluZyIsInNldFZlbG9jaXR5WSIsInNldFZlbG9jaXR5WCIsIlBhdXNlU2NlbmUiLCJkYXRhIiwicmVzdW1lQnRuIiwiaG9tZUJ0biIsInR5cGUiLCJ3aWR0aCIsImhlaWdodCIsInBhcmVudCIsImRlZmF1bHQiLCJhcmNhZGUiLCJncmF2aXR5IiwiZGVidWciLCJiYWNrZ3JvdW5kQ29sb3IiXSwic291cmNlUm9vdCI6IiJ9